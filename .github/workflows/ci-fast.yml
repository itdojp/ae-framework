name: CI Fast
on:
  pull_request:
    types: [opened, synchronize, reopened, ready_for_review, labeled]
  push:
    branches: [main, develop]
    tags: ['v*']
  workflow_dispatch:
  workflow_call:
    # Allow release workflow to reuse this fast CI
concurrency:
  group: ci-fast-${{ github.ref }}
  cancel-in-progress: true
permissions: read-all
jobs:
  unit:
    uses: ./.github/workflows/common/ci-core.yml
    with:
      node-version: '20'
      run-script: test:unit
  fast:
    uses: ./.github/workflows/common/ci-core.yml
    with:
      node-version: '20'
      run-script: test:fast
  fast-commands:
    if: ${{ github.event_name != 'pull_request' || contains(github.event.pull_request.labels.*.name, 'qa-batch:commands') }}
    uses: ./.github/workflows/common/ci-core.yml
    with:
      node-version: '20'
      run-script: test:fast:batch:commands
  fast-cli:
    if: ${{ github.event_name != 'pull_request' || contains(github.event.pull_request.labels.*.name, 'qa-batch:cli') }}
    uses: ./.github/workflows/common/ci-core.yml
    with:
      node-version: '20'
      run-script: test:fast:batch:cli
  fast-property:
    if: ${{ github.event_name != 'pull_request' || contains(github.event.pull_request.labels.*.name, 'qa-batch:property') }}
    uses: ./.github/workflows/common/ci-core.yml
    with:
      node-version: '20'
      run-script: test:fast:batch:property
  fast-agents:
    if: ${{ github.event_name != 'pull_request' || contains(github.event.pull_request.labels.*.name, 'qa-batch:agents') }}
    uses: ./.github/workflows/common/ci-core.yml
    with:
      node-version: '20'
      run-script: test:fast:batch:agents
  lint:
    uses: ./.github/workflows/common/ci-core.yml
    with:
      node-version: '20'
      run-script: lint
