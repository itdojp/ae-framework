name: Quality Gates
on:
  pull_request:
    # Run quality gates only when code paths change
    paths:
      - 'src/**'
      - 'packages/**'
      - 'apps/**'
      - 'tests/**'
      - 'configs/**'
      - 'scripts/**'
      - 'types/**'
  workflow_call:
    # Allow reuse from other workflows (e.g., release)
    inputs:
      environment:
        required: false
        type: string
permissions: read-all
jobs:
  integration:
    uses: ./.github/workflows/common/ci-core.yml
    with:
      node-version: '20'
      run-script: test:int
  types:
    uses: ./.github/workflows/common/ci-core.yml
    with:
      node-version: '20'
      run-script: types:check
  a11y:
    uses: ./.github/workflows/common/ci-core.yml
    with:
      node-version: '20'
      run-script: test:a11y
  coverage:
    uses: ./.github/workflows/common/ci-core.yml
    with:
      node-version: '20'
      run-script: test:coverage
  types-tests:
    uses: ./.github/workflows/common/ci-core.yml
    with:
      node-version: '20'
      run-script: test:types
