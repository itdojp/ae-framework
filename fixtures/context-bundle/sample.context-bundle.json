{
  "schemaVersion": "0.1.0",
  "taskIntent": "post-envelope-comment: missing envelope file should fail with clear error",
  "systemConstraints": [
    "Node.js 20",
    "TypeScript",
    "No breaking changes"
  ],
  "roles": ["cli", "tests"],
  "artifacts": [
    {
      "type": "source",
      "path": "src/trace/post-envelope-comment.ts",
      "role": "cli",
      "commit": "HEAD",
      "description": "CLI entry for posting envelope comments"
    },
    {
      "type": "test",
      "path": "tests/unit/trace/post-envelope-comment.test.ts",
      "role": "tests",
      "description": "Regression tests for missing envelope handling"
    },
    {
      "type": "schema",
      "path": "schema/envelope.schema.json",
      "role": "spec",
      "description": "Envelope schema (traceCorrelation, artifacts)"
    }
  ],
  "assumptions": [
    "CLI exits with code 1 on fatal error"
  ],
  "contracts": {
    "preconditions": [
      "Envelope JSON exists before command execution",
      {
        "id": "PRE-CLI-001",
        "statement": "Input file path points to readable JSON",
        "scope": "src/trace/post-envelope-comment.ts",
        "severity": "high",
        "source": "trace CLI",
        "notes": "Reject unreadable or malformed JSON with exit code 1"
      }
    ],
    "postconditions": [
      {
        "id": "POST-CLI-001",
        "statement": "CLI writes a result envelope comment summary",
        "scope": "artifacts/verify-lite/verify-lite-run-summary.json",
        "severity": "medium",
        "source": "verify-lite"
      }
    ],
    "invariants": [
      {
        "id": "INV-TRACE-001",
        "statement": "traceCorrelation fields remain schema-compliant",
        "scope": "schema/envelope.schema.json",
        "severity": "critical",
        "source": "envelope schema"
      }
    ]
  },
  "openQuestions": [
    "Should stderr message format be asserted strictly?"
  ],
  "contextVacuum": {
    "status": "ok",
    "missing": []
  },
  "metadata": {
    "owner": "trace",
    "priority": "medium"
  }
}
