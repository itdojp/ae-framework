# Elixir Verification Environment
FROM elixir:1.15-alpine as base

# Install system dependencies
RUN apk add --no-cache \
    build-base \
    git \
    curl

# Install Hex and Rebar
RUN mix local.hex --force && \
    mix local.rebar --force

# Set up workspace
WORKDIR /workspace
VOLUME ["/workspace", "/output"]

# Verification target
FROM base as verification
ENV MIX_ENV=test
ENV ERL_CRASH_DUMP=/dev/null

# Default command
CMD ["mix", "compile"]
